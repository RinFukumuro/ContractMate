# 弁護士業務支援用 Word文書ナビゲーションツール（統合版）

## 概要
このツールは、弁護士業務の効率化を目的としたWord文書操作ツールです。Windows Script Host (WSH)とActiveXObjectを使用して、Word文書を開き、文書内の段落構造を解析し、特定の段落に即座に移動することができます。複数のバージョンの機能を統合し、エラーハンドリングを強化した統合版です。

## 主な機能
- ✅ Word文書を即座に開く
- ✅ 文書の全段落構造を取得（条項や見出しも判別可能）
- ✅ 特定の条項や段落番号を指定し、即座にその場所にジャンプ
- ✅ キーワードを指定して、該当する段落に移動
- ✅ 文書内の見出しのみを抽出して表示
- ✅ 詳細なエラーメッセージと進捗表示

## 必要環境
- Windows OS
- Microsoft Word
- Windows Script Host (WSH)

## 使用方法

### 基本的な使用方法
コマンドプロンプトまたはPowerShellから以下のコマンドを実行します：

```
cscript wordNavigator_integrated.js [Word文書パス] [移動したい段落番号]
```

### キーワード検索モード
特定のキーワードを含む段落を検索して移動します：

```
cscript wordNavigator_integrated.js [Word文書パス] -k [検索キーワード]
```

### 見出し表示モード
文書内の見出しのみを抽出して表示します：

```
cscript wordNavigator_integrated.js [Word文書パス] -h
```

### 文書構造のみを表示
文書の段落構造のみを表示します（移動はしません）：

```
cscript wordNavigator_integrated.js [Word文書パス]
```

## 引数の説明
1. `[Word文書パス]` - 開きたいWord文書のパス（.docまたは.docx）
2. `[移動したい段落番号]` - ジャンプしたい段落の番号（1から始まる整数）
   または `-k [検索キーワード]` - 検索するキーワード
   または `-h` - 見出し表示モード

## 実行例

### 例1: 特定の段落に移動
```
cscript wordNavigator_integrated.js "C:\契約書\賃貸契約書.docx" 12
```
この例では、「賃貸契約書.docx」を開き、12番目の段落に自動的にジャンプします。

### 例2: キーワード検索
```
cscript wordNavigator_integrated.js "C:\契約書\賃貸契約書.docx" -k "賠償責任"
```
この例では、「賃貸契約書.docx」を開き、「賠償責任」というキーワードを含む最初の段落に移動します。

### 例3: 見出し表示
```
cscript wordNavigator_integrated.js "C:\契約書\賃貸契約書.docx" -h
```
この例では、「賃貸契約書.docx」を開き、文書内の見出しのみを抽出して表示します。

## 出力情報
実行すると、以下の情報が表示されます：
- 処理の進捗状況
- 文書内の全段落の情報（段落番号、スタイル名、アウトラインレベル、テキスト内容）
- エラーメッセージ（発生した場合）

## 活用例
- 契約書の特定条項を即座に参照する
- クライアントとの打合せ中に必要な条文を素早く提示する
- 長文の法律文書内を効率的に移動する
- 複数の文書間で同様の条項を比較検討する
- 文書の検索・確認作業の時間を大幅に短縮する
- 文書の見出し構造を把握し、目次を作成する

## 注意事項
- このスクリプトを実行するには、セキュリティ設定でActiveXObjectの使用が許可されている必要があります。
- 初回実行時にセキュリティ警告が表示される場合があります。
- 処理が完了しても、Wordは自動的に終了しません。確認後、手動でWordを閉じてください。

## エラーが発生した場合
エラーが発生した場合は、以下を確認してください：
1. Microsoft Wordが正しくインストールされているか
2. 指定したWord文書が存在するか
3. パスに日本語や特殊文字が含まれている場合は、引用符（"）で囲んでいるか
4. セキュリティ設定でActiveXObjectの使用が許可されているか

## 開発者向け情報
このスクリプトは、以下のクラスとメソッドで構成されています：

- **WordNavigator** - メインクラス
  - **openDocument(filePath)** - Word文書を開く
  - **getParagraphStructure()** - 文書の段落構造を取得
  - **navigateToParagraph(paragraphNumber)** - 指定した段落番号に移動
  - **navigateToKeyword(keyword)** - キーワードを含む段落に移動
  - **getHeadings()** - 見出しのみを抽出
  - **closeDocument(save)** - 文書を閉じる
  - **quit()** - Wordアプリケーションを終了

カスタマイズや機能拡張が必要な場合は、これらのメソッドを修正または拡張してください。